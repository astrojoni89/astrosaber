

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>astrosaber package &#8212; astrosaber v0.2.1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'astrosaber';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="astrosaber.utils package" href="astrosaber.utils.html" />
    <link rel="prev" title="astrosaber" href="modules.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">astrosaber v0.2.1</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="modules.html">
                        astrosaber
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="modules.html">
                        astrosaber
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">astrosaber package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="astrosaber.utils.html">astrosaber.utils package</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="modules.html" class="nav-link">astrosaber</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">astrosaber package</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="astrosaber-package">
<h1>astrosaber package<a class="headerlink" href="#astrosaber-package" title="Permalink to this heading">#</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading">#</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="astrosaber.utils.html">astrosaber.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="astrosaber.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="astrosaber.utils.html#module-astrosaber.utils.aslsq_fit">astrosaber.utils.aslsq_fit module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_fit.baseline_als"><code class="docutils literal notranslate"><span class="pre">baseline_als()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_fit.baseline_als_optimized"><code class="docutils literal notranslate"><span class="pre">baseline_als_optimized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_fit.one_step_extraction"><code class="docutils literal notranslate"><span class="pre">one_step_extraction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_fit.two_step_extraction"><code class="docutils literal notranslate"><span class="pre">two_step_extraction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="astrosaber.utils.html#module-astrosaber.utils.aslsq_helper">astrosaber.utils.aslsq_helper module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_helper.IterationWarning"><code class="docutils literal notranslate"><span class="pre">IterationWarning</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_helper.check_signal"><code class="docutils literal notranslate"><span class="pre">check_signal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_helper.check_signal_ranges"><code class="docutils literal notranslate"><span class="pre">check_signal_ranges()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_helper.count_ones_in_row"><code class="docutils literal notranslate"><span class="pre">count_ones_in_row()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_helper.find_nearest"><code class="docutils literal notranslate"><span class="pre">find_nearest()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_helper.format_warning"><code class="docutils literal notranslate"><span class="pre">format_warning()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_helper.md_header_2d"><code class="docutils literal notranslate"><span class="pre">md_header_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_helper.merge_ranges"><code class="docutils literal notranslate"><span class="pre">merge_ranges()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_helper.pixel_to_world"><code class="docutils literal notranslate"><span class="pre">pixel_to_world()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_helper.say"><code class="docutils literal notranslate"><span class="pre">say()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.aslsq_helper.velocity_axes"><code class="docutils literal notranslate"><span class="pre">velocity_axes()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="astrosaber.utils.html#module-astrosaber.utils.grogu">astrosaber.utils.grogu module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.grogu.TqdmDefaultWriteLock"><code class="docutils literal notranslate"><span class="pre">TqdmDefaultWriteLock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.grogu.TqdmDefaultWriteLock.acquire"><code class="docutils literal notranslate"><span class="pre">TqdmDefaultWriteLock.acquire()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.grogu.TqdmDefaultWriteLock.release"><code class="docutils literal notranslate"><span class="pre">TqdmDefaultWriteLock.release()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.grogu.yoda"><code class="docutils literal notranslate"><span class="pre">yoda</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.grogu.yoda.monitor"><code class="docutils literal notranslate"><span class="pre">yoda.monitor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.grogu.yoda.monitor_interval"><code class="docutils literal notranslate"><span class="pre">yoda.monitor_interval</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="astrosaber.utils.html#module-astrosaber.utils.quality_checks">astrosaber.utils.quality_checks module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.quality_checks.determine_peaks"><code class="docutils literal notranslate"><span class="pre">determine_peaks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.quality_checks.get_max_consecutive_channels"><code class="docutils literal notranslate"><span class="pre">get_max_consecutive_channels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.quality_checks.goodness_of_fit"><code class="docutils literal notranslate"><span class="pre">goodness_of_fit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.quality_checks.mask_channels"><code class="docutils literal notranslate"><span class="pre">mask_channels()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="astrosaber.utils.html#module-astrosaber.utils.spectrum_utils">astrosaber.utils.spectrum_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.spectrum_utils.calculate_spectrum"><code class="docutils literal notranslate"><span class="pre">calculate_spectrum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.spectrum_utils.pixel_circle_calculation"><code class="docutils literal notranslate"><span class="pre">pixel_circle_calculation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="astrosaber.utils.html#astrosaber.utils.spectrum_utils.pixel_circle_calculation_px"><code class="docutils literal notranslate"><span class="pre">pixel_circle_calculation_px()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="astrosaber.utils.html#module-astrosaber.utils">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-astrosaber.hisa">
<span id="astrosaber-hisa-module"></span><h2>astrosaber.hisa module<a class="headerlink" href="#module-astrosaber.hisa" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">astrosaber.hisa.</span></span><span class="sig-name descname"><span class="pre">HisaExtraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitsfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_noise_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'two'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations_for_convergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_residual</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velo_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_signal_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_flags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baby_yoda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.hisa.HisaExtraction" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class used to execute the self-absorption extraction.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.fitsfile">
<span class="sig-name descname"><span class="pre">fitsfile</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.fitsfile" title="Permalink to this definition">#</a></dt>
<dd><p>Name of the fitsfile.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.path_to_noise_map">
<span class="sig-name descname"><span class="pre">path_to_noise_map</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.path_to_noise_map" title="Permalink to this definition">#</a></dt>
<dd><p>Path to the noise map.
If no noise map is given, a single value must be provided instead using the ‘noise’ attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.path_to_data">
<span class="sig-name descname"><span class="pre">path_to_data</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.path_to_data" title="Permalink to this definition">#</a></dt>
<dd><p>Path to the fitsfile.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.smoothing">
<span class="sig-name descname"><span class="pre">smoothing</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.smoothing" title="Permalink to this definition">#</a></dt>
<dd><p>Whether to execute the asymmetric least squares smoothing routine.
Default is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.phase">
<span class="sig-name descname"><span class="pre">phase</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.phase" title="Permalink to this definition">#</a></dt>
<dd><p>Mode of saber smoothing.
Either ‘one’ or ‘two’ (default) phase smoothing. Default is ‘two’.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.lam1">
<span class="sig-name descname"><span class="pre">lam1</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.lam1" title="Permalink to this definition">#</a></dt>
<dd><p>Lambda_1 smoothing parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.p1">
<span class="sig-name descname"><span class="pre">p1</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.p1" title="Permalink to this definition">#</a></dt>
<dd><p>Asymmetry weight of the minor cycle smoothing.
Default is 0.90.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.lam2">
<span class="sig-name descname"><span class="pre">lam2</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.lam2" title="Permalink to this definition">#</a></dt>
<dd><p>Lambda_2 smoothing parameter. Has to be specified if phase is set to ‘two’.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.p2">
<span class="sig-name descname"><span class="pre">p2</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.p2" title="Permalink to this definition">#</a></dt>
<dd><p>Asymmetry weight of the major cycle smoothing.
Has to be specified if phase is set to ‘two’. Default is 0.90.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.niters">
<span class="sig-name descname"><span class="pre">niters</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.niters" title="Permalink to this definition">#</a></dt>
<dd><p>Maximum number of iterations of the smoothing.
Default is 20.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.iterations_for_convergence">
<span class="sig-name descname"><span class="pre">iterations_for_convergence</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.iterations_for_convergence" title="Permalink to this definition">#</a></dt>
<dd><p>Number of iterations of the major cycle for the baseline to be considered converged.
Default is 3.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.noise">
<span class="sig-name descname"><span class="pre">noise</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.noise" title="Permalink to this definition">#</a></dt>
<dd><p>Noise level of the data. Has to be specified if no path to noise map is given.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.add_residual">
<span class="sig-name descname"><span class="pre">add_residual</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.add_residual" title="Permalink to this definition">#</a></dt>
<dd><p>Whether to add the residual (=difference between first and last major cycle iteration) to the baseline.
Default is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.sig">
<span class="sig-name descname"><span class="pre">sig</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.sig" title="Permalink to this definition">#</a></dt>
<dd><p>Defines how many sigma of the noise is used as a convergence criterion.
If the change in baseline between major cycle iterations is smaller than ‘sig’ * noise for ‘iterations_for_convergence’,
then the baseline is considered converged. Default is 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.velo_range">
<span class="sig-name descname"><span class="pre">velo_range</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.velo_range" title="Permalink to this definition">#</a></dt>
<dd><p>Velocity range [in km/s] of the spectra that has to contain significant signal
for it to be considered in the baseline extraction. Default is 15.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.check_signal_sigma">
<span class="sig-name descname"><span class="pre">check_signal_sigma</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.check_signal_sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Defines the significance of the signal that has to be present in the spectra
for at least the range defined by ‘velo_range’. Default is 6.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.output_flags">
<span class="sig-name descname"><span class="pre">output_flags</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.output_flags" title="Permalink to this definition">#</a></dt>
<dd><p>Whether to save a mask containing the flags.
Default is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.baby_yoda">
<span class="sig-name descname"><span class="pre">baby_yoda</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.baby_yoda" title="Permalink to this definition">#</a></dt>
<dd><p>Whether to show a star wars-themed progress bar.
Default is False.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.p_limit">
<span class="sig-name descname"><span class="pre">p_limit</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.p_limit" title="Permalink to this definition">#</a></dt>
<dd><p>The p-limit of the Markov chain to estimate signal ranges in the spectra.
Default is 0.02.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.ncpus">
<span class="sig-name descname"><span class="pre">ncpus</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.ncpus" title="Permalink to this definition">#</a></dt>
<dd><p>Number of CPUs to use.
Defaults to 50% of the available CPUs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.suffix">
<span class="sig-name descname"><span class="pre">suffix</span></span><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.suffix" title="Permalink to this definition">#</a></dt>
<dd><p>Optional suffix to add to the output filenames.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.getting_ready">
<span class="sig-name descname"><span class="pre">getting_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.getting_ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.getting_ready" title="Permalink to this definition">#</a></dt>
<dd><p>Prints a message when preparation starts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepares the extraction by reading in data and put them in a raveled list of spectra.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.saber">
<span class="sig-name descname"><span class="pre">saber</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.saber"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.saber" title="Permalink to this definition">#</a></dt>
<dd><p>Runs the self-absorption extraction and saves the data.
It takes the instance attributes and reads in the noise to kick off the extraction routine.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.two_step_extraction_single">
<span class="sig-name descname"><span class="pre">two_step_extraction_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.two_step_extraction_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.two_step_extraction_single" title="Permalink to this definition">#</a></dt>
<dd><p>Runs the two-phase extraction for a single spectrum i.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.one_step_extraction_single">
<span class="sig-name descname"><span class="pre">one_step_extraction_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.one_step_extraction_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.one_step_extraction_single" title="Permalink to this definition">#</a></dt>
<dd><p>Runs the one-phase extraction for a single spectrum i.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.hisa.HisaExtraction.save_data">
<span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.hisa.HisaExtraction.save_data" title="Permalink to this definition">#</a></dt>
<dd><p>Saves all the extracted data into FITS files.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#id0" title="astrosaber.hisa.HisaExtraction.getting_ready"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getting_ready</span></code></a>()</p></td>
<td><p>Prints a message when preparation starts.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id1" title="astrosaber.hisa.HisaExtraction.one_step_extraction_single"><code class="xref py py-obj docutils literal notranslate"><span class="pre">one_step_extraction_single</span></code></a>(i)</p></td>
<td><p>Runs the one-phase extraction for a single spectrum i.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id2" title="astrosaber.hisa.HisaExtraction.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a>()</p></td>
<td><p>Prepares the extraction by reading in data and put them in a raveled list of spectra.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id3" title="astrosaber.hisa.HisaExtraction.saber"><code class="xref py py-obj docutils literal notranslate"><span class="pre">saber</span></code></a>()</p></td>
<td><p>Runs the self-absorption extraction and saves the data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id4" title="astrosaber.hisa.HisaExtraction.save_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_data</span></code></a>()</p></td>
<td><p>Saves all the extracted data into FITS files.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id5" title="astrosaber.hisa.HisaExtraction.two_step_extraction_single"><code class="xref py py-obj docutils literal notranslate"><span class="pre">two_step_extraction_single</span></code></a>(i)</p></td>
<td><p>Runs the two-phase extraction for a single spectrum i.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">getting_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.getting_ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition">#</a></dt>
<dd><p>Prints a message when preparation starts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">one_step_extraction_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.one_step_extraction_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Permalink to this definition">#</a></dt>
<dd><p>Runs the one-phase extraction for a single spectrum i.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>i</strong> (<em>int</em>) – Index of input spectrum.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>index_1d</strong> (<em>int</em>) – Index of the spectrum.</p></li>
<li><p><strong>bg</strong> (<em>numpy.ndarray</em>) – Background spectrum w/o self-absorption.</p></li>
<li><p><strong>hisa</strong> (<em>numpy.ndarray</em>) – Inverted self-absorption spectrum (i.e. expressed as equivalent emission).</p></li>
<li><p><strong>iterations</strong> (<em>int</em>) – Number of iterations until algorithm converged.</p></li>
<li><p><strong>flag_map</strong> (<em>int</em>) – Flag whether background did/did not converge or whether spectrum does/does not contain signal.
If flag is 1, the were no issues in the fit. If 0, fit did not converge or did not contain signal.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Permalink to this definition">#</a></dt>
<dd><p>Prepares the extraction by reading in data and put them in a raveled list of spectra.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">saber</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.saber"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Permalink to this definition">#</a></dt>
<dd><p>Runs the self-absorption extraction and saves the data.
It takes the instance attributes and reads in the noise to kick off the extraction routine.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Permalink to this definition">#</a></dt>
<dd><p>Saves all the extracted data into FITS files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">two_step_extraction_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/astrosaber/hisa.html#HisaExtraction.two_step_extraction_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Permalink to this definition">#</a></dt>
<dd><p>Runs the two-phase extraction for a single spectrum i.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>i</strong> (<em>int</em>) – Index of input spectrum.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>index_1d</strong> (<em>int</em>) – Index of the spectrum.</p></li>
<li><p><strong>bg</strong> (<em>numpy.ndarray</em>) – Background spectrum w/o self-absorption.</p></li>
<li><p><strong>hisa</strong> (<em>numpy.ndarray</em>) – Inverted self-absorption spectrum (i.e. expressed as equivalent emission).</p></li>
<li><p><strong>iterations</strong> (<em>int</em>) – Number of iterations until algorithm converged.</p></li>
<li><p><strong>flag_map</strong> (<em>int</em>) – Flag whether background did/did not converge or whether spectrum does/does not contain signal.
If flag is 1, the were no issues in the fit. If 0, fit did not converge or did not contain signal.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-astrosaber.parallel_processing">
<span id="astrosaber-parallel-processing-module"></span><h2>astrosaber.parallel_processing module<a class="headerlink" href="#module-astrosaber.parallel_processing" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.parallel_processing.func">
<span class="sig-prename descclassname"><span class="pre">astrosaber.parallel_processing.</span></span><span class="sig-name descname"><span class="pre">func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">use_ncpus:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">function:</span> <span class="pre">~typing.Optional[~typing.Callable[[...],</span> <span class="pre">~typing.Tuple]]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">bar=&lt;class</span> <span class="pre">'tqdm.std.tqdm'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/parallel_processing.html#func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.parallel_processing.func" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.parallel_processing.func_wo_bar">
<span class="sig-prename descclassname"><span class="pre">astrosaber.parallel_processing.</span></span><span class="sig-name descname"><span class="pre">func_wo_bar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_ncpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/parallel_processing.html#func_wo_bar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.parallel_processing.func_wo_bar" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.parallel_processing.init">
<span class="sig-prename descclassname"><span class="pre">astrosaber.parallel_processing.</span></span><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mp_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/parallel_processing.html#init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.parallel_processing.init" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes global params for parallel process.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.parallel_processing.lambda_extraction_i">
<span class="sig-prename descclassname"><span class="pre">astrosaber.parallel_processing.</span></span><span class="sig-name descname"><span class="pre">lambda_extraction_i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/astrosaber/parallel_processing.html#lambda_extraction_i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.parallel_processing.lambda_extraction_i" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.parallel_processing.one_step_i">
<span class="sig-prename descclassname"><span class="pre">astrosaber.parallel_processing.</span></span><span class="sig-name descname"><span class="pre">one_step_i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/astrosaber/parallel_processing.html#one_step_i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.parallel_processing.one_step_i" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.parallel_processing.parallel_process">
<span class="sig-prename descclassname"><span class="pre">astrosaber.parallel_processing.</span></span><span class="sig-name descname"><span class="pre">parallel_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">array:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">function:</span> <span class="pre">~typing.Callable[[int],</span> <span class="pre">~typing.Tuple],</span> <span class="pre">n_jobs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">4,</span> <span class="pre">use_kwargs:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">front_num:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3,</span> <span class="pre">bar:</span> <span class="pre">~typing.Callable[[~typing.Iterable],</span> <span class="pre">None]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'tqdm.std.tqdm'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/parallel_processing.html#parallel_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.parallel_processing.parallel_process" title="Permalink to this definition">#</a></dt>
<dd><p>A parallel version of the map function with a progress bar.
Credit: <a class="reference external" href="http://danshiebler.com/2016-09-14-parallel-progress-bar/">http://danshiebler.com/2016-09-14-parallel-progress-bar/</a></p>
<dl class="simple">
<dt>array<span class="classifier">numpy.ndarray</span></dt><dd><p>An array to iterate over.</p>
</dd>
<dt>function<span class="classifier">func</span></dt><dd><p>A python function to apply to the elements of array.</p>
</dd>
<dt>n_jobs<span class="classifier">int</span></dt><dd><p>The number of cores to use.</p>
</dd>
<dt>use_kwargs<span class="classifier">bool</span></dt><dd><p>Whether to consider the elements of array as dictionaries of
keyword arguments to function. Default is False.</p>
</dd>
<dt>front_num<span class="classifier">int</span></dt><dd><p>The number of iterations to run serially before kicking off the parallel job.
Useful for catching bugs. Default is 3.</p>
</dd>
<dt>Returns:</dt><dd><p>[function(array[0]), function(array[1]), …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.parallel_processing.parallel_process_wo_bar">
<span class="sig-prename descclassname"><span class="pre">astrosaber.parallel_processing.</span></span><span class="sig-name descname"><span class="pre">parallel_process_wo_bar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">front_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/parallel_processing.html#parallel_process_wo_bar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.parallel_processing.parallel_process_wo_bar" title="Permalink to this definition">#</a></dt>
<dd><p>A parallel version of the map function with a progress bar.
Credit: <a class="reference external" href="http://danshiebler.com/2016-09-14-parallel-progress-bar/">http://danshiebler.com/2016-09-14-parallel-progress-bar/</a></p>
<dl class="simple">
<dt>array<span class="classifier">numpy.ndarray</span></dt><dd><p>An array to iterate over.</p>
</dd>
<dt>function<span class="classifier">func</span></dt><dd><p>A python function to apply to the elements of array.</p>
</dd>
<dt>n_jobs<span class="classifier">int</span></dt><dd><p>The number of cores to use.</p>
</dd>
<dt>use_kwargs<span class="classifier">bool</span></dt><dd><p>Whether to consider the elements of array as dictionaries of
keyword arguments to function. Default is False.</p>
</dd>
<dt>front_num<span class="classifier">int</span></dt><dd><p>The number of iterations to run serially before kicking off the parallel job.
Useful for catching bugs. Default is 3.</p>
</dd>
<dt>Returns:</dt><dd><p>[function(array[0]), function(array[1]), …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.parallel_processing.single_cost_i">
<span class="sig-prename descclassname"><span class="pre">astrosaber.parallel_processing.</span></span><span class="sig-name descname"><span class="pre">single_cost_i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/astrosaber/parallel_processing.html#single_cost_i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.parallel_processing.single_cost_i" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.parallel_processing.two_step_i">
<span class="sig-prename descclassname"><span class="pre">astrosaber.parallel_processing.</span></span><span class="sig-name descname"><span class="pre">two_step_i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/astrosaber/parallel_processing.html#two_step_i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.parallel_processing.two_step_i" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-astrosaber.plotting">
<span id="astrosaber-plotting-module"></span><h2>astrosaber.plotting module<a class="headerlink" href="#module-astrosaber.plotting" title="Permalink to this heading">#</a></h2>
<p>plotting functions</p>
<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.add_figure_properties">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">add_figure_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Unit('km</span> <span class="pre">/</span> <span class="pre">s')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#add_figure_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.add_figure_properties" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.get_figure_params">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">get_figure_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_spectra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowbreak</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#get_figure_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.get_figure_params" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.get_title_string">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">get_title_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rchi2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#get_title_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.get_title_string" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.pickle_load_file">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">pickle_load_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pathToFile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#pickle_load_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.pickle_load_file" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.plot_pickle_spectra">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_pickle_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pickle_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spectra.pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_spectra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowbreak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">72</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-110,</span> <span class="pre">163]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Unit('km</span> <span class="pre">/</span> <span class="pre">s')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">111</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#plot_pickle_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.plot_pickle_spectra" title="Permalink to this definition">#</a></dt>
<dd><p>pickle_file: pickled file to plot spectra from</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.plot_signal_ranges">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_signal_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_channels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#plot_signal_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.plot_signal_ranges" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.plot_spectra">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitsfiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spectra.pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_spectra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowbreak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">72</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-110,</span> <span class="pre">163]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Unit('km</span> <span class="pre">/</span> <span class="pre">s')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">111</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#plot_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.plot_spectra" title="Permalink to this definition">#</a></dt>
<dd><p>fitsfiles: list of fitsfiles to plot spectra from
coordinates: array of central coordinates [[Glon, Glat]] to plot spectra from
radius: radius of area to be averaged for each spectrum [arcseconds]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.scale_fontsize">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">scale_fontsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rowsize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#scale_fontsize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.scale_fontsize" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.styles">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">styles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#styles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.styles" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.styles_pickle">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">styles_pickle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#styles_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.styles_pickle" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.xlabel_from_header">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">xlabel_from_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_unit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#xlabel_from_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.xlabel_from_header" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="astrosaber.plotting.ylabel_from_header">
<span class="sig-prename descclassname"><span class="pre">astrosaber.plotting.</span></span><span class="sig-name descname"><span class="pre">ylabel_from_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/plotting.html#ylabel_from_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.plotting.ylabel_from_header" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-astrosaber.prepare_training">
<span id="astrosaber-prepare-training-module"></span><h2>astrosaber.prepare_training module<a class="headerlink" href="#module-astrosaber.prepare_training" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">astrosaber.prepare_training.</span></span><span class="sig-name descname"><span class="pre">saberPrepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitsfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_set_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_noise_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_amp_snr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_amp_snr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_linewidth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_linewidth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_ncomponent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_ncomponent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_velocities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_velocities_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations_for_convergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_residual</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velo_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_signal_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">111</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/prepare_training.html#saberPrepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class used to obtain and prepare training data for the optimization.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.fitsfile">
<span class="sig-name descname"><span class="pre">fitsfile</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.fitsfile" title="Permalink to this definition">#</a></dt>
<dd><p>Name of the fitsfile.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.training_set_size">
<span class="sig-name descname"><span class="pre">training_set_size</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.training_set_size" title="Permalink to this definition">#</a></dt>
<dd><p>Number of spectra to draw from the data.
Default is 100.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.path_to_noise_map">
<span class="sig-name descname"><span class="pre">path_to_noise_map</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.path_to_noise_map" title="Permalink to this definition">#</a></dt>
<dd><p>Path to the noise map.
If no noise map is given, a single value must be provided instead using the ‘noise’ attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.path_to_data">
<span class="sig-name descname"><span class="pre">path_to_data</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.path_to_data" title="Permalink to this definition">#</a></dt>
<dd><p>Path to the fitsfile.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.mean_amp_snr">
<span class="sig-name descname"><span class="pre">mean_amp_snr</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.mean_amp_snr" title="Permalink to this definition">#</a></dt>
<dd><p>Mean of amplitude distribution.
This sets the mean value of the Gaussian distribution of self-absorption amplitude values
from which the training data are generated. Default is 7.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int | float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.std_amp_snr">
<span class="sig-name descname"><span class="pre">std_amp_snr</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.std_amp_snr" title="Permalink to this definition">#</a></dt>
<dd><p>Standard deviation of amplitude distribution.
This sets the standard deviation of the Gaussian distribution of self-absorption amplitude values
from which the training data are generated. Default is 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int | float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.mean_linewidth">
<span class="sig-name descname"><span class="pre">mean_linewidth</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.mean_linewidth" title="Permalink to this definition">#</a></dt>
<dd><p>Mean of linewidth distribution in units of km/s [FWHM].
This sets the mean value of the Gaussian distribution of self-absorption linewidths
from which the training data are generated. Default is None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int | float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.std_linewidth">
<span class="sig-name descname"><span class="pre">std_linewidth</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.std_linewidth" title="Permalink to this definition">#</a></dt>
<dd><p>Standard deviation of linewidth distribution in units of km/s [FWHM].
This sets the standard deviation of the Gaussian distribution of self-absorption linewidths
from which the training data are generated. Default is None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int | float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.mean_ncomponent">
<span class="sig-name descname"><span class="pre">mean_ncomponent</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.mean_ncomponent" title="Permalink to this definition">#</a></dt>
<dd><p>Mean number of self-absorption components.
This sets the mean value of the Gaussian distribution
from which the number of self-absorption features added per spectrum is determined.
Default is 2.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int | float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.std_ncomponent">
<span class="sig-name descname"><span class="pre">std_ncomponent</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.std_ncomponent" title="Permalink to this definition">#</a></dt>
<dd><p>Standard deviation of self-absorption components.
This sets the standard deviation of the Gaussian distribution
from which the number of self-absorption features added per spectrum is determined.
Default is 0.5.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int | float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.fix_velocities">
<span class="sig-name descname"><span class="pre">fix_velocities</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.fix_velocities" title="Permalink to this definition">#</a></dt>
<dd><p>List of fixed velocities where self-absorption features should be added (in units of the third axis in the fits file).
If the velocities of absorption features are known, this information can be provided here to aid the optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.fix_velocities_sigma">
<span class="sig-name descname"><span class="pre">fix_velocities_sigma</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.fix_velocities_sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Standard deviation of the fixed velocities.
If a list of fixed velocities is given, some ‘wiggle room’ defined by this attribute can be added.
This is the standard deviation of a Gaussian distribution around the fixed velocities
in units of the third axis of the fits file. The default is one spectral channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.lam1">
<span class="sig-name descname"><span class="pre">lam1</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.lam1" title="Permalink to this definition">#</a></dt>
<dd><p>Lambda_1 smoothing parameter to generate test data.
Default is 2.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.p1">
<span class="sig-name descname"><span class="pre">p1</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.p1" title="Permalink to this definition">#</a></dt>
<dd><p>Asymmetry weight of the minor cycle smoothing to generate test data.
Default is 0.90.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.lam2">
<span class="sig-name descname"><span class="pre">lam2</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.lam2" title="Permalink to this definition">#</a></dt>
<dd><p>Lambda_2 smoothing parameter to generate test data.
Default is 2.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.p2">
<span class="sig-name descname"><span class="pre">p2</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.p2" title="Permalink to this definition">#</a></dt>
<dd><p>Asymmetry weight of the major cycle smoothing to generate test data.
Default is 0.90.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.niters">
<span class="sig-name descname"><span class="pre">niters</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.niters" title="Permalink to this definition">#</a></dt>
<dd><p>Maximum number of iterations of the smoothing.
Only used to generate test data. Default is 20.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.iterations_for_convergence">
<span class="sig-name descname"><span class="pre">iterations_for_convergence</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.iterations_for_convergence" title="Permalink to this definition">#</a></dt>
<dd><p>Number of iterations of the major cycle for the baseline to be considered converged.
Only used to generate test data. Default is 3.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.noise">
<span class="sig-name descname"><span class="pre">noise</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.noise" title="Permalink to this definition">#</a></dt>
<dd><p>Noise level of the data. Has to be specified if no path to noise map is given.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.add_residual">
<span class="sig-name descname"><span class="pre">add_residual</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.add_residual" title="Permalink to this definition">#</a></dt>
<dd><p>Whether to add the residual (=difference between first and last major cycle iteration) to the baseline.
Only used to generate test data. Default is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.sig">
<span class="sig-name descname"><span class="pre">sig</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.sig" title="Permalink to this definition">#</a></dt>
<dd><p>Defines how many sigma of the noise is used as a convergence criterion.
If the change in baseline between major cycle iterations is smaller than ‘sig’ * noise for ‘iterations_for_convergence’,
then the baseline is considered converged. Only used to generate test data. Default is 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.velo_range">
<span class="sig-name descname"><span class="pre">velo_range</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.velo_range" title="Permalink to this definition">#</a></dt>
<dd><p>Velocity range [in km/s] of the spectra that has to contain significant signal
for it to be considered in the baseline extraction. Default is 15.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.check_signal_sigma">
<span class="sig-name descname"><span class="pre">check_signal_sigma</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.check_signal_sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Defines the significance of the signal that has to be present in the spectra
for at least the range defined by ‘velo_range’. Default is 6.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.p_limit">
<span class="sig-name descname"><span class="pre">p_limit</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.p_limit" title="Permalink to this definition">#</a></dt>
<dd><p>The p-limit of the Markov chain to estimate signal ranges in the spectra.
Default is 0.01.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.ncpus">
<span class="sig-name descname"><span class="pre">ncpus</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.ncpus" title="Permalink to this definition">#</a></dt>
<dd><p>Number of CPUs to use.
Defaults to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.suffix">
<span class="sig-name descname"><span class="pre">suffix</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.suffix" title="Permalink to this definition">#</a></dt>
<dd><p>Optional suffix to add to the output filenames.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.filename_out">
<span class="sig-name descname"><span class="pre">filename_out</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.filename_out" title="Permalink to this definition">#</a></dt>
<dd><p>Output filename of the pickled file that contains the training and test data.
The default is the fits filename base with the number of training spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.path_to_file">
<span class="sig-name descname"><span class="pre">path_to_file</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.path_to_file" title="Permalink to this definition">#</a></dt>
<dd><p>Optional path to where the pickled training data should be stored.
The training data are stored by default in the subfolder ‘astrosaber_training’
of the working directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.seed" title="Permalink to this definition">#</a></dt>
<dd><p>Seed to initialize the random generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.getting_ready">
<span class="sig-name descname"><span class="pre">getting_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/prepare_training.html#saberPrepare.getting_ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.getting_ready" title="Permalink to this definition">#</a></dt>
<dd><p>Prints a message when preparation starts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/prepare_training.html#saberPrepare.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepares the training data by reading in data and
setting up lists for Gaussian parameter distributions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.prepare_training">
<span class="sig-name descname"><span class="pre">prepare_training</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/prepare_training.html#saberPrepare.prepare_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.prepare_training" title="Permalink to this definition">#</a></dt>
<dd><p>Creates the test and training data and saves them into a pickled file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.two_step_extraction_prepare">
<span class="sig-name descname"><span class="pre">two_step_extraction_prepare</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/prepare_training.html#saberPrepare.two_step_extraction_prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.two_step_extraction_prepare" title="Permalink to this definition">#</a></dt>
<dd><p>Runs the two-phase smoothing with default parameters to generate test data and self-absorption parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.prepare_training.saberPrepare.save_data">
<span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/prepare_training.html#saberPrepare.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.prepare_training.saberPrepare.save_data" title="Permalink to this definition">#</a></dt>
<dd><p>Saves all the test and training data into a pickled file.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#id6" title="astrosaber.prepare_training.saberPrepare.getting_ready"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getting_ready</span></code></a>()</p></td>
<td><p>Prints a message when preparation starts.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id7" title="astrosaber.prepare_training.saberPrepare.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a>()</p></td>
<td><p>Prepares the training data by reading in data and setting up lists for Gaussian parameter distributions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id8" title="astrosaber.prepare_training.saberPrepare.prepare_training"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_training</span></code></a>()</p></td>
<td><p>Creates the test and training data and saves them into a pickled file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id9" title="astrosaber.prepare_training.saberPrepare.save_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_data</span></code></a>()</p></td>
<td><p>Saves all the test and training data into a pickled file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id10" title="astrosaber.prepare_training.saberPrepare.two_step_extraction_prepare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">two_step_extraction_prepare</span></code></a>(i)</p></td>
<td><p>Runs the two-phase smoothing with default parameters to generate test data and self-absorption parameters.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">getting_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/prepare_training.html#saberPrepare.getting_ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Permalink to this definition">#</a></dt>
<dd><p>Prints a message when preparation starts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/prepare_training.html#saberPrepare.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Permalink to this definition">#</a></dt>
<dd><p>Prepares the training data by reading in data and
setting up lists for Gaussian parameter distributions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">prepare_training</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/prepare_training.html#saberPrepare.prepare_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Permalink to this definition">#</a></dt>
<dd><p>Creates the test and training data and saves them into a pickled file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/prepare_training.html#saberPrepare.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Permalink to this definition">#</a></dt>
<dd><p>Saves all the test and training data into a pickled file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">two_step_extraction_prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/astrosaber/prepare_training.html#saberPrepare.two_step_extraction_prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id10" title="Permalink to this definition">#</a></dt>
<dd><p>Runs the two-phase smoothing with default parameters to generate test data and self-absorption parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>mock_emission</strong> (<em>numpy.ndarray</em>) – ‘Pure’ emission spectrum w/o self-absorption.</p></li>
<li><p><strong>mask_ranges</strong> (<em>numpy.ndarray</em>) – Array of range indices that contain signal.</p></li>
<li><p><strong>mask</strong> (<em>numpy.ndarray</em>) – Array of signal mask.</p></li>
<li><p><strong>mu_amps_HISA</strong> (<em>float</em>) – Mean amplitude value of self-absorption features.</p></li>
<li><p><strong>sigma_amps_HISA</strong> (<em>float</em>) – Standard deviation of self-absorption features.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-astrosaber.training">
<span id="astrosaber-training-module"></span><h2>astrosaber.training module<a class="headerlink" href="#module-astrosaber.training" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">astrosaber.training.</span></span><span class="sig-name descname"><span class="pre">saberTraining</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pickle_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'two'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam1_initial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam2_initial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam1_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam2_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAD</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_l1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_l2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_l1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_l2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_trace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations_for_convergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_residual</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velo_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_signal_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">111</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class used to optimize smoothing parameters based on training data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.picklefile">
<span class="sig-name descname"><span class="pre">picklefile</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.picklefile" title="Permalink to this definition">#</a></dt>
<dd><p>Name of the pickled file to use as an input.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.path_to_data">
<span class="sig-name descname"><span class="pre">path_to_data</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.path_to_data" title="Permalink to this definition">#</a></dt>
<dd><p>Path to the pickled file.
Default is the working directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.iterations">
<span class="sig-name descname"><span class="pre">iterations</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.iterations" title="Permalink to this definition">#</a></dt>
<dd><p>Maximum number of iterations for gradient descent algorithm.
Default is 100.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.phase">
<span class="sig-name descname"><span class="pre">phase</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.phase" title="Permalink to this definition">#</a></dt>
<dd><p>Mode of saber smoothing.
Either <cite>one</cite> or <cite>two</cite> (default) phase smoothing. Default is <cite>two</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.lam1_initial">
<span class="sig-name descname"><span class="pre">lam1_initial</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.lam1_initial" title="Permalink to this definition">#</a></dt>
<dd><p>Initial value of the Lambda_1 smoothing parameter that is to be optimized.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.p1">
<span class="sig-name descname"><span class="pre">p1</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.p1" title="Permalink to this definition">#</a></dt>
<dd><p>Asymmetry weight of the minor (and major if phase=`one`) cycle smoothing.
Default is 0.90.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">lam1_initial</span></span><a class="headerlink" href="#id11" title="Permalink to this definition">#</a></dt>
<dd><p>Initial value of the Lambda_2 smoothing parameter that is to be optimized.
Has to be specified if phase is set to <cite>two</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.p2">
<span class="sig-name descname"><span class="pre">p2</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.p2" title="Permalink to this definition">#</a></dt>
<dd><p>Asymmetry weight of the major cycle smoothing to generate test data.
Default is 0.90.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.weight_1">
<span class="sig-name descname"><span class="pre">weight_1</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.weight_1" title="Permalink to this definition">#</a></dt>
<dd><p>(DEPRECATED) Additional penalty that can be imposed on the Lambda_1 smoothing weight.
This is deprecated and will be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.weight_2">
<span class="sig-name descname"><span class="pre">weight_2</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.weight_2" title="Permalink to this definition">#</a></dt>
<dd><p>(DEPRECATED) Additional penalty that can be imposed on the Lambda_2 smoothing weight.
This is deprecated and will be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.lam1_bounds">
<span class="sig-name descname"><span class="pre">lam1_bounds</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.lam1_bounds" title="Permalink to this definition">#</a></dt>
<dd><p>List of two constraints on Lambda_1 smoothing parameter to limit the parameter space.
Default is [0.1, 100.].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.lam2_bounds">
<span class="sig-name descname"><span class="pre">lam2_bounds</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.lam2_bounds" title="Permalink to this definition">#</a></dt>
<dd><p>List of two constraints on Lambda_2 smoothing parameter to limit the parameter space.
Default is [0.1, 100.].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.MAD">
<span class="sig-name descname"><span class="pre">MAD</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.MAD" title="Permalink to this definition">#</a></dt>
<dd><p>Median absolute difference that is used together with <cite>window_size</cite> as a convergence threshold for optimization.
Default is 0.03.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.window_size">
<span class="sig-name descname"><span class="pre">window_size</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.window_size" title="Permalink to this definition">#</a></dt>
<dd><p>Trailing window size to determine convergence.
Default is 10 (iterations).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.eps_l1">
<span class="sig-name descname"><span class="pre">eps_l1</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.eps_l1" title="Permalink to this definition">#</a></dt>
<dd><p>Epsilon value to compute parameter space derivative in Lambda_1 direction.
Default is 0.1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.eps_l2">
<span class="sig-name descname"><span class="pre">eps_l2</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.eps_l2" title="Permalink to this definition">#</a></dt>
<dd><p>Epsilon value to compute parameter space derivative in Lambda_2 direction.
Default is 0.1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.learning_rate_l1">
<span class="sig-name descname"><span class="pre">learning_rate_l1</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.learning_rate_l1" title="Permalink to this definition">#</a></dt>
<dd><p>Step size to go in direction of Lambda_1 derivative at each iteration.
Default is 0.5.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.learning_rate_l2">
<span class="sig-name descname"><span class="pre">learning_rate_l2</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.learning_rate_l2" title="Permalink to this definition">#</a></dt>
<dd><p>Step size to go in direction of Lambda_2 derivative at each iteration.
Default is 0.5.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.mom">
<span class="sig-name descname"><span class="pre">mom</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.mom" title="Permalink to this definition">#</a></dt>
<dd><p>Momentum that influences the following step in the gradient descent run.
Default is 0.3.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.get_trace">
<span class="sig-name descname"><span class="pre">get_trace</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.get_trace" title="Permalink to this definition">#</a></dt>
<dd><p>If get_trace is set to True, the tracks of (lam1,lam2) will be returned and saved,
instead of the final optimized smoothing parameters. Default is False.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.niters">
<span class="sig-name descname"><span class="pre">niters</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.niters" title="Permalink to this definition">#</a></dt>
<dd><p>Maximum number of iterations of the smoothing.
Only used to generate test data. Default is 20.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.iterations_for_convergence">
<span class="sig-name descname"><span class="pre">iterations_for_convergence</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.iterations_for_convergence" title="Permalink to this definition">#</a></dt>
<dd><p>Number of iterations of the major cycle for the baseline to be considered converged.
Only used to generate test data. Default is 3.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.add_residual">
<span class="sig-name descname"><span class="pre">add_residual</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.add_residual" title="Permalink to this definition">#</a></dt>
<dd><p>Whether to add the residual (=difference between first and last major cycle iteration) to the baseline.
Only used to generate test data. Default is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.sig">
<span class="sig-name descname"><span class="pre">sig</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.sig" title="Permalink to this definition">#</a></dt>
<dd><p>Defines how many sigma of the noise is used as a convergence criterion.
If the change in baseline between major cycle iterations is smaller than <cite>sig</cite> * noise for <cite>iterations_for_convergence</cite>,
then the baseline is considered converged. Only used to generate test data. Default is 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.velo_range">
<span class="sig-name descname"><span class="pre">velo_range</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.velo_range" title="Permalink to this definition">#</a></dt>
<dd><p>Velocity range [km/s] of the spectra that has to contain significant signal
for it to be considered in the baseline extraction. Default is 15.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.check_signal_sigma">
<span class="sig-name descname"><span class="pre">check_signal_sigma</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.check_signal_sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Defines the significance of the signal that has to be present in the spectra
for at least the range defined by ‘velo_range’. Default is 6.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.p_limit">
<span class="sig-name descname"><span class="pre">p_limit</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.p_limit" title="Permalink to this definition">#</a></dt>
<dd><p>The p-limit of the Markov chain to estimate signal ranges in the spectra.
Default is 0.01.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.ncpus">
<span class="sig-name descname"><span class="pre">ncpus</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.ncpus" title="Permalink to this definition">#</a></dt>
<dd><p>Number of CPUs to use.
Defaults to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.suffix">
<span class="sig-name descname"><span class="pre">suffix</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.suffix" title="Permalink to this definition">#</a></dt>
<dd><p>Optional suffix to add to the output filenames.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.filename_out">
<span class="sig-name descname"><span class="pre">filename_out</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.filename_out" title="Permalink to this definition">#</a></dt>
<dd><p>Output filename of the pickled file that contains the training and test data.
The default is the fits filename base with the number of training spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#astrosaber.training.saberTraining.seed" title="Permalink to this definition">#</a></dt>
<dd><p>Seed to initialize the random generator.
Default is 111.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.getting_ready">
<span class="sig-name descname"><span class="pre">getting_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.getting_ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.getting_ready" title="Permalink to this definition">#</a></dt>
<dd><p>Prints a message when preparation starts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepares the optimization by reading in data and
setting parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.training">
<span class="sig-name descname"><span class="pre">training</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.training" title="Permalink to this definition">#</a></dt>
<dd><p>Prepares the data and kicks off the optimization routine.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.train" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes the Lambda smoothing parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.objective_function_lambda_set">
<span class="sig-name descname"><span class="pre">objective_function_lambda_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.objective_function_lambda_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.objective_function_lambda_set" title="Permalink to this definition">#</a></dt>
<dd><p>Kicks off the parallel process and computes the cost function based on the current Lambda parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.single_cost">
<span class="sig-name descname"><span class="pre">single_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.single_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.single_cost" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the cost, and optionally the reduced chi square and the median absolute deviation (MAD)
of a single spectrum fit.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.single_cost_endofloop">
<span class="sig-name descname"><span class="pre">single_cost_endofloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.single_cost_endofloop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.single_cost_endofloop" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the cost, and optionally the reduced chi square and the median absolute deviation (MAD)
of a single spectrum fit using fixed lambda values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.gradient_descent_lambda_set">
<span class="sig-name descname"><span class="pre">gradient_descent_lambda_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.gradient_descent_lambda_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.gradient_descent_lambda_set" title="Permalink to this definition">#</a></dt>
<dd><p>Book-keeping object of the gradient descent.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.train_lambda_set">
<span class="sig-name descname"><span class="pre">train_lambda_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.train_lambda_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.train_lambda_set" title="Permalink to this definition">#</a></dt>
<dd><p>Performs the gradient descent using an objective function
(which is in this case the cost function evaluated for asymmetric smoothing with lambda_1, lambda_2 parameters).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.save_data">
<span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.save_data" title="Permalink to this definition">#</a></dt>
<dd><p>If get_trace is set to False, this will save the optimized Lambda smoothing parameters in a .txt file.
If get_trace is set to True, this will save the tracks of Lambda positions in the parameter space in a .txt file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.update_pickle_file">
<span class="sig-name descname"><span class="pre">update_pickle_file</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.update_pickle_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.update_pickle_file" title="Permalink to this definition">#</a></dt>
<dd><p>Updates the input pickle file with final background fit
and reduced chi square value for each training spectrum and saves the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="astrosaber.training.saberTraining.save_pickle">
<span class="sig-name descname"><span class="pre">save_pickle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.save_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.training.saberTraining.save_pickle" title="Permalink to this definition">#</a></dt>
<dd><p>Saves the updated pickle file.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#id12" title="astrosaber.training.saberTraining.getting_ready"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getting_ready</span></code></a>()</p></td>
<td><p>Prints a message when preparation starts.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id13" title="astrosaber.training.saberTraining.gradient_descent_lambda_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient_descent_lambda_set</span></code></a>(iterations)</p></td>
<td><p>Bookkeeping object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id14" title="astrosaber.training.saberTraining.objective_function_lambda_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">objective_function_lambda_set</span></code></a>(lam1, p1, lam2, p2)</p></td>
<td><p>Kicks off the parallel process and computes the cost function based on the current Lambda parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id15" title="astrosaber.training.saberTraining.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a>()</p></td>
<td><p>Prepares the optimization by reading in data and setting parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id16" title="astrosaber.training.saberTraining.save_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_data</span></code></a>()</p></td>
<td><p>If get_trace is set to False, this will save the optimized Lambda smoothing parameters in a .txt file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id17" title="astrosaber.training.saberTraining.save_pickle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_pickle</span></code></a>()</p></td>
<td><p>Saves the updated pickle file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id18" title="astrosaber.training.saberTraining.single_cost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">single_cost</span></code></a>(i[, get_all])</p></td>
<td><p>Computes the cost, and optionally the reduced chi square and the median absolute deviation (MAD) of a single spectrum fit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id19" title="astrosaber.training.saberTraining.single_cost_endofloop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">single_cost_endofloop</span></code></a>(i[, lam1_final, ...])</p></td>
<td><p>Computes the cost, and optionally the reduced chi square and the median absolute deviation (MAD) of a single spectrum fit using fixed lambda values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id20" title="astrosaber.training.saberTraining.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>()</p></td>
<td><p>Optimizes the Lambda smoothing parameter(s).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id21" title="astrosaber.training.saberTraining.train_lambda_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_lambda_set</span></code></a>(objective_function[, ...])</p></td>
<td><p>Performs the gradient descent using an objective function (which is in this case the cost function evaluated for asymmetric smoothing with lambda_1, lambda_2 parameters).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id22" title="astrosaber.training.saberTraining.training"><code class="xref py py-obj docutils literal notranslate"><span class="pre">training</span></code></a>()</p></td>
<td><p>Prepares the data using <code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code> and calls the methods <code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">save_data()</span></code>; and <code class="xref py py-meth docutils literal notranslate"><span class="pre">update_pickle_file()</span></code> and <a class="reference internal" href="#astrosaber.plotting.plot_pickle_spectra" title="astrosaber.plotting.plot_pickle_spectra"><code class="xref py py-func docutils literal notranslate"><span class="pre">astrosaber.plotting.plot_pickle_spectra()</span></code></a> if get_trace is set to False.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id23" title="astrosaber.training.saberTraining.update_pickle_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_pickle_file</span></code></a>(training_data, lam1, lam2)</p></td>
<td><p>Updates the input pickle file with final background fit and reduced chi square value for each training spectrum and saves the data.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">getting_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.getting_ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id12" title="Permalink to this definition">#</a></dt>
<dd><p>Prints a message when preparation starts.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id13">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gradient_descent_lambda_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.gradient_descent_lambda_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id13" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bookkeeping object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">objective_function_lambda_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_all</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.objective_function_lambda_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id14" title="Permalink to this definition">#</a></dt>
<dd><p>Kicks off the parallel process and computes the cost function based on the current Lambda parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lam1</strong> (<em>float</em>) – Lambda_1 smoothing parameter.</p></li>
<li><p><strong>p1</strong> (<em>float</em>) – Asymmetry weight parameter.</p></li>
<li><p><strong>lam2</strong> (<em>float</em>) – Lambda_2 smoothing parameter.</p></li>
<li><p><strong>p2</strong> (<em>float</em>) – Asymmetry weight parameter</p></li>
<li><p><strong>get_all</strong> (<em>bool</em><em>, </em><em>optional</em>) – If get_all is set to True, it will return the median results of the cost function, the reduced chi square, and the median absolute deviation (MAD).
If set to False, it will return just the median result of the costs.</p></li>
<li><p><strong>ncpus</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of CPUs to use.
Defaults to 50% of the available CPUs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cost</strong> (<em>float</em>) – Median of costs.</p></li>
<li><p><strong>rchi2</strong> (<em>float</em>) – Median of reduced chi square values. Only returned if get_all=True.</p></li>
<li><p><strong>MAD</strong> (<em>float</em>) – Median of MAD values. Only returned if get_all=True.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id15" title="Permalink to this definition">#</a></dt>
<dd><p>Prepares the optimization by reading in data and
setting parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id16" title="Permalink to this definition">#</a></dt>
<dd><p>If get_trace is set to False, this will save the optimized Lambda smoothing parameters in a .txt file.
If get_trace is set to True, this will save the tracks of Lambda positions in the parameter space in a .txt file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">save_pickle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.save_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id17" title="Permalink to this definition">#</a></dt>
<dd><p>Saves the updated pickle file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">single_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_all</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.single_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id18" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the cost, and optionally the reduced chi square and the median absolute deviation (MAD)
of a single spectrum fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – Index of spectrum.</p></li>
<li><p><strong>get_all</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to True (default), returns cost, reduced chi square, and MAD.
If False, returns only cost.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cost</strong> (<em>float</em>) – Cost.
In this case, it is the reduced chi square.</p></li>
<li><p><strong>rchi2</strong> (<em>float</em>) – Reduced chi square value. Only returned if get_all=True.</p></li>
<li><p><strong>MAD</strong> (<em>float</em>) – MAD value. Only returned if get_all=True.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">single_cost_endofloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam1_final</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam2_final</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_all</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.single_cost_endofloop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id19" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the cost, and optionally the reduced chi square and the median absolute deviation (MAD)
of a single spectrum fit using fixed lambda values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – Index of spectrum.</p></li>
<li><p><strong>lam1_final</strong> (<em>float</em>) – Final lambda_1 smoothing parameter.</p></li>
<li><p><strong>lam2_final</strong> (<em>float</em>) – Final lambda_2 smoothing parameter.</p></li>
<li><p><strong>get_all</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to True (default), returns cost, reduced chi square, and MAD.
If False, returns only cost.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cost</strong> (<em>float</em>) – Cost.
In this case, it is the reduced chi square.</p></li>
<li><p><strong>rchi2</strong> (<em>float</em>) – Reduced chi square value. Only returned if get_all=True.</p></li>
<li><p><strong>MAD</strong> (<em>float</em>) – MAD value. Only returned if get_all=True.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id20" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes the Lambda smoothing parameter(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>popt_lam</strong> – Optimized Lambda parameters.
Returns an array of lambda positions from the gradient descent run if <cite>get_trace</cite> is set to True.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">train_lambda_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objective_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam1_initial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam2_initial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam1_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam2_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAD</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_l1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_l2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_l1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_l2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations_for_convergence_training</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_trace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.train_lambda_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id21" title="Permalink to this definition">#</a></dt>
<dd><p>Performs the gradient descent using an objective function
(which is in this case the cost function evaluated for asymmetric smoothing with lambda_1, lambda_2 parameters).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>objective_function</strong> (<em>func</em>) – Objective function whose parameters are to be optimized.</p></li>
<li><p><strong>training_data</strong> (<em>numpy.ndarray</em>) – Array containing training spectra.</p></li>
<li><p><strong>test_data</strong> (<em>numpy.ndarray</em>) – Array containing reference test spectra to evaluate the goodness of fit after each iteration.</p></li>
<li><p><strong>noise</strong> (<em>numpy.ndarray</em>) – Array of noise values.
Array of length N, with N being the number of training spectra.</p></li>
<li><p><strong>lam1_initial</strong> (<em>float</em>) – Initial lambda_1 parameter at which gradient descent takes off.</p></li>
<li><p><strong>p1</strong> (<em>float</em>) – Asymmetry weight of first major cycle iteration. Default is None.</p></li>
<li><p><strong>lam2_initial</strong> (<em>float</em>) – Initial lambda_2 parameter at which gradient descent takes off.</p></li>
<li><p><strong>p2</strong> (<em>float</em>) – Asymmetry weight of following major cycle iterations. Default is None.</p></li>
<li><p><strong>lam1_bounds</strong> (<em>List</em>) – Imposed bounds of the lambda_1 parameter.
If the gradient descent converges toward a value that is outside the range given by lam1_bounds,
the next iteration of the gradient descent will be pushed in the other direction by an amount that is 0.1 times the current lam1 location.
Default is [0.1, 100.]</p></li>
<li><p><strong>lam2_bounds</strong> (<em>List</em>) – Imposed bounds of the lambda_2 parameter.
If the gradient descent converges toward a value that is outside the range given by lam2_bounds,
the next iteration of the gradient descent will be pushed in the other direction by an amount that is 0.1 times the current lam2 location.
Default is [0.1, 100.]</p></li>
<li><p><strong>iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations to reach a stable convergence.
If the gradient descent did not converge until then, the lambda values at this point will be saved.
Default is 100.</p></li>
<li><p><strong>MAD</strong> (<em>float</em><em>, </em><em>optional</em>) – Mean absolute deviation used as a convergence threshold.
Defaults to 0.03.</p></li>
<li><p><strong>eps_l1</strong> (<em>float</em><em>, </em><em>optional</em>) – Finite offset for computing derivatives in gradient in direction of lambda_1,lambda_2.
Defaults to 0.1</p></li>
<li><p><strong>eps_l2</strong> (<em>float</em><em>, </em><em>optional</em>) – Finite offset for computing derivatives in gradient in direction of lambda_1,lambda_2.
Defaults to 0.1</p></li>
<li><p><strong>learning_rate_l1</strong> (<em>float</em><em>, </em><em>optional</em>) – Step size to go during optimization in direction of gradient of objective_function(lam1,lam2).
Defaults to 0.5.</p></li>
<li><p><strong>learning_rate_l2</strong> (<em>float</em><em>, </em><em>optional</em>) – Step size to go during optimization in direction of gradient of objective_function(lam1,lam2).
Defaults to 0.5.</p></li>
<li><p><strong>mom</strong> (<em>float</em><em>, </em><em>optional</em>) – Momentum value.
Defaults to 0.3.</p></li>
<li><p><strong>window_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Trailing window size to determine convergence.
Default=10.</p></li>
<li><p><strong>iterations_for_convergence_training</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of continuous iterations within threshold tolerence required to achieve convergence.
Default=10.</p></li>
<li><p><strong>get_trace</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to save the lambda traces instead of final values.
Default is False.</p></li>
<li><p><strong>ncpus</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of CPUs to use. Defaults to 0.5 of the available CPUs.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the lam1, lam2 traces if get_trace is True. Else it returns the lam1, lam2 value after the gradient descent terminates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">training</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id22" title="Permalink to this definition">#</a></dt>
<dd><p>Prepares the data using <code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code>
and calls the methods <code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code>,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">save_data()</span></code>; and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">update_pickle_file()</span></code> and <a class="reference internal" href="#astrosaber.plotting.plot_pickle_spectra" title="astrosaber.plotting.plot_pickle_spectra"><code class="xref py py-func docutils literal notranslate"><span class="pre">astrosaber.plotting.plot_pickle_spectra()</span></code></a>
if get_trace is set to False.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">update_pickle_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/astrosaber/training.html#saberTraining.update_pickle_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id23" title="Permalink to this definition">#</a></dt>
<dd><p>Updates the input pickle file with final background fit
and reduced chi square value for each training spectrum and saves the data.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-astrosaber">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-astrosaber" title="Permalink to this heading">#</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="astrosaber.UnsupportedPythonError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">astrosaber.</span></span><span class="sig-name descname"><span class="pre">UnsupportedPythonError</span></span><a class="reference internal" href="_modules/astrosaber.html#UnsupportedPythonError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astrosaber.UnsupportedPythonError" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="modules.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">astrosaber</p>
      </div>
    </a>
    <a class="right-next"
       href="astrosaber.utils.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">astrosaber.utils package</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subpackages">Subpackages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-astrosaber.hisa">astrosaber.hisa module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction"><code class="docutils literal notranslate"><span class="pre">HisaExtraction</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.fitsfile"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.fitsfile</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.path_to_noise_map"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.path_to_noise_map</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.path_to_data"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.path_to_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.smoothing"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.smoothing</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.phase"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.phase</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.lam1"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.lam1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.p1"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.p1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.lam2"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.lam2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.p2"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.p2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.niters"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.niters</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.iterations_for_convergence"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.iterations_for_convergence</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.noise"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.noise</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.add_residual"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.add_residual</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.sig"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.sig</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.velo_range"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.velo_range</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.check_signal_sigma"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.check_signal_sigma</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.output_flags"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.output_flags</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.baby_yoda"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.baby_yoda</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.p_limit"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.p_limit</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.ncpus"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.ncpus</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.suffix"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.suffix</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.getting_ready"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.getting_ready()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.prepare_data"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.prepare_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.saber"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.saber()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.two_step_extraction_single"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.two_step_extraction_single()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.one_step_extraction_single"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.one_step_extraction_single()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.hisa.HisaExtraction.save_data"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.save_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id0"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.getting_ready()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.one_step_extraction_single()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.prepare_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.saber()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.save_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><code class="docutils literal notranslate"><span class="pre">HisaExtraction.two_step_extraction_single()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-astrosaber.parallel_processing">astrosaber.parallel_processing module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.parallel_processing.func"><code class="docutils literal notranslate"><span class="pre">func()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.parallel_processing.func_wo_bar"><code class="docutils literal notranslate"><span class="pre">func_wo_bar()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.parallel_processing.init"><code class="docutils literal notranslate"><span class="pre">init()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.parallel_processing.lambda_extraction_i"><code class="docutils literal notranslate"><span class="pre">lambda_extraction_i()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.parallel_processing.one_step_i"><code class="docutils literal notranslate"><span class="pre">one_step_i()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.parallel_processing.parallel_process"><code class="docutils literal notranslate"><span class="pre">parallel_process()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.parallel_processing.parallel_process_wo_bar"><code class="docutils literal notranslate"><span class="pre">parallel_process_wo_bar()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.parallel_processing.single_cost_i"><code class="docutils literal notranslate"><span class="pre">single_cost_i()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.parallel_processing.two_step_i"><code class="docutils literal notranslate"><span class="pre">two_step_i()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-astrosaber.plotting">astrosaber.plotting module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.add_figure_properties"><code class="docutils literal notranslate"><span class="pre">add_figure_properties()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.get_figure_params"><code class="docutils literal notranslate"><span class="pre">get_figure_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.get_title_string"><code class="docutils literal notranslate"><span class="pre">get_title_string()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.pickle_load_file"><code class="docutils literal notranslate"><span class="pre">pickle_load_file()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.plot_pickle_spectra"><code class="docutils literal notranslate"><span class="pre">plot_pickle_spectra()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.plot_signal_ranges"><code class="docutils literal notranslate"><span class="pre">plot_signal_ranges()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.plot_spectra"><code class="docutils literal notranslate"><span class="pre">plot_spectra()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.scale_fontsize"><code class="docutils literal notranslate"><span class="pre">scale_fontsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.styles"><code class="docutils literal notranslate"><span class="pre">styles()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.styles_pickle"><code class="docutils literal notranslate"><span class="pre">styles_pickle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.xlabel_from_header"><code class="docutils literal notranslate"><span class="pre">xlabel_from_header()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.plotting.ylabel_from_header"><code class="docutils literal notranslate"><span class="pre">ylabel_from_header()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-astrosaber.prepare_training">astrosaber.prepare_training module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare"><code class="docutils literal notranslate"><span class="pre">saberPrepare</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.fitsfile"><code class="docutils literal notranslate"><span class="pre">saberPrepare.fitsfile</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.training_set_size"><code class="docutils literal notranslate"><span class="pre">saberPrepare.training_set_size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.path_to_noise_map"><code class="docutils literal notranslate"><span class="pre">saberPrepare.path_to_noise_map</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.path_to_data"><code class="docutils literal notranslate"><span class="pre">saberPrepare.path_to_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.mean_amp_snr"><code class="docutils literal notranslate"><span class="pre">saberPrepare.mean_amp_snr</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.std_amp_snr"><code class="docutils literal notranslate"><span class="pre">saberPrepare.std_amp_snr</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.mean_linewidth"><code class="docutils literal notranslate"><span class="pre">saberPrepare.mean_linewidth</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.std_linewidth"><code class="docutils literal notranslate"><span class="pre">saberPrepare.std_linewidth</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.mean_ncomponent"><code class="docutils literal notranslate"><span class="pre">saberPrepare.mean_ncomponent</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.std_ncomponent"><code class="docutils literal notranslate"><span class="pre">saberPrepare.std_ncomponent</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.fix_velocities"><code class="docutils literal notranslate"><span class="pre">saberPrepare.fix_velocities</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.fix_velocities_sigma"><code class="docutils literal notranslate"><span class="pre">saberPrepare.fix_velocities_sigma</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.lam1"><code class="docutils literal notranslate"><span class="pre">saberPrepare.lam1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.p1"><code class="docutils literal notranslate"><span class="pre">saberPrepare.p1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.lam2"><code class="docutils literal notranslate"><span class="pre">saberPrepare.lam2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.p2"><code class="docutils literal notranslate"><span class="pre">saberPrepare.p2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.niters"><code class="docutils literal notranslate"><span class="pre">saberPrepare.niters</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.iterations_for_convergence"><code class="docutils literal notranslate"><span class="pre">saberPrepare.iterations_for_convergence</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.noise"><code class="docutils literal notranslate"><span class="pre">saberPrepare.noise</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.add_residual"><code class="docutils literal notranslate"><span class="pre">saberPrepare.add_residual</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.sig"><code class="docutils literal notranslate"><span class="pre">saberPrepare.sig</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.velo_range"><code class="docutils literal notranslate"><span class="pre">saberPrepare.velo_range</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.check_signal_sigma"><code class="docutils literal notranslate"><span class="pre">saberPrepare.check_signal_sigma</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.p_limit"><code class="docutils literal notranslate"><span class="pre">saberPrepare.p_limit</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.ncpus"><code class="docutils literal notranslate"><span class="pre">saberPrepare.ncpus</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.suffix"><code class="docutils literal notranslate"><span class="pre">saberPrepare.suffix</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.filename_out"><code class="docutils literal notranslate"><span class="pre">saberPrepare.filename_out</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.path_to_file"><code class="docutils literal notranslate"><span class="pre">saberPrepare.path_to_file</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.seed"><code class="docutils literal notranslate"><span class="pre">saberPrepare.seed</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.getting_ready"><code class="docutils literal notranslate"><span class="pre">saberPrepare.getting_ready()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.prepare_data"><code class="docutils literal notranslate"><span class="pre">saberPrepare.prepare_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.prepare_training"><code class="docutils literal notranslate"><span class="pre">saberPrepare.prepare_training()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.two_step_extraction_prepare"><code class="docutils literal notranslate"><span class="pre">saberPrepare.two_step_extraction_prepare()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.prepare_training.saberPrepare.save_data"><code class="docutils literal notranslate"><span class="pre">saberPrepare.save_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><code class="docutils literal notranslate"><span class="pre">saberPrepare.getting_ready()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><code class="docutils literal notranslate"><span class="pre">saberPrepare.prepare_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><code class="docutils literal notranslate"><span class="pre">saberPrepare.prepare_training()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="docutils literal notranslate"><span class="pre">saberPrepare.save_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><code class="docutils literal notranslate"><span class="pre">saberPrepare.two_step_extraction_prepare()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-astrosaber.training">astrosaber.training module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining"><code class="docutils literal notranslate"><span class="pre">saberTraining</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.picklefile"><code class="docutils literal notranslate"><span class="pre">saberTraining.picklefile</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.path_to_data"><code class="docutils literal notranslate"><span class="pre">saberTraining.path_to_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.iterations"><code class="docutils literal notranslate"><span class="pre">saberTraining.iterations</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.phase"><code class="docutils literal notranslate"><span class="pre">saberTraining.phase</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.lam1_initial"><code class="docutils literal notranslate"><span class="pre">saberTraining.lam1_initial</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.p1"><code class="docutils literal notranslate"><span class="pre">saberTraining.p1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><code class="docutils literal notranslate"><span class="pre">saberTraining.lam1_initial</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.p2"><code class="docutils literal notranslate"><span class="pre">saberTraining.p2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.weight_1"><code class="docutils literal notranslate"><span class="pre">saberTraining.weight_1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.weight_2"><code class="docutils literal notranslate"><span class="pre">saberTraining.weight_2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.lam1_bounds"><code class="docutils literal notranslate"><span class="pre">saberTraining.lam1_bounds</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.lam2_bounds"><code class="docutils literal notranslate"><span class="pre">saberTraining.lam2_bounds</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.MAD"><code class="docutils literal notranslate"><span class="pre">saberTraining.MAD</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.window_size"><code class="docutils literal notranslate"><span class="pre">saberTraining.window_size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.eps_l1"><code class="docutils literal notranslate"><span class="pre">saberTraining.eps_l1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.eps_l2"><code class="docutils literal notranslate"><span class="pre">saberTraining.eps_l2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.learning_rate_l1"><code class="docutils literal notranslate"><span class="pre">saberTraining.learning_rate_l1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.learning_rate_l2"><code class="docutils literal notranslate"><span class="pre">saberTraining.learning_rate_l2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.mom"><code class="docutils literal notranslate"><span class="pre">saberTraining.mom</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.get_trace"><code class="docutils literal notranslate"><span class="pre">saberTraining.get_trace</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.niters"><code class="docutils literal notranslate"><span class="pre">saberTraining.niters</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.iterations_for_convergence"><code class="docutils literal notranslate"><span class="pre">saberTraining.iterations_for_convergence</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.add_residual"><code class="docutils literal notranslate"><span class="pre">saberTraining.add_residual</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.sig"><code class="docutils literal notranslate"><span class="pre">saberTraining.sig</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.velo_range"><code class="docutils literal notranslate"><span class="pre">saberTraining.velo_range</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.check_signal_sigma"><code class="docutils literal notranslate"><span class="pre">saberTraining.check_signal_sigma</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.p_limit"><code class="docutils literal notranslate"><span class="pre">saberTraining.p_limit</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.ncpus"><code class="docutils literal notranslate"><span class="pre">saberTraining.ncpus</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.suffix"><code class="docutils literal notranslate"><span class="pre">saberTraining.suffix</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.filename_out"><code class="docutils literal notranslate"><span class="pre">saberTraining.filename_out</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.seed"><code class="docutils literal notranslate"><span class="pre">saberTraining.seed</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.getting_ready"><code class="docutils literal notranslate"><span class="pre">saberTraining.getting_ready()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.prepare_data"><code class="docutils literal notranslate"><span class="pre">saberTraining.prepare_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.training"><code class="docutils literal notranslate"><span class="pre">saberTraining.training()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.train"><code class="docutils literal notranslate"><span class="pre">saberTraining.train()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.objective_function_lambda_set"><code class="docutils literal notranslate"><span class="pre">saberTraining.objective_function_lambda_set()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.single_cost"><code class="docutils literal notranslate"><span class="pre">saberTraining.single_cost()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.single_cost_endofloop"><code class="docutils literal notranslate"><span class="pre">saberTraining.single_cost_endofloop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.gradient_descent_lambda_set"><code class="docutils literal notranslate"><span class="pre">saberTraining.gradient_descent_lambda_set()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.train_lambda_set"><code class="docutils literal notranslate"><span class="pre">saberTraining.train_lambda_set()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.save_data"><code class="docutils literal notranslate"><span class="pre">saberTraining.save_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.update_pickle_file"><code class="docutils literal notranslate"><span class="pre">saberTraining.update_pickle_file()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.training.saberTraining.save_pickle"><code class="docutils literal notranslate"><span class="pre">saberTraining.save_pickle()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><code class="docutils literal notranslate"><span class="pre">saberTraining.getting_ready()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><code class="docutils literal notranslate"><span class="pre">saberTraining.gradient_descent_lambda_set</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><code class="docutils literal notranslate"><span class="pre">saberTraining.objective_function_lambda_set()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><code class="docutils literal notranslate"><span class="pre">saberTraining.prepare_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"><code class="docutils literal notranslate"><span class="pre">saberTraining.save_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17"><code class="docutils literal notranslate"><span class="pre">saberTraining.save_pickle()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18"><code class="docutils literal notranslate"><span class="pre">saberTraining.single_cost()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19"><code class="docutils literal notranslate"><span class="pre">saberTraining.single_cost_endofloop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20"><code class="docutils literal notranslate"><span class="pre">saberTraining.train()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id21"><code class="docutils literal notranslate"><span class="pre">saberTraining.train_lambda_set()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id22"><code class="docutils literal notranslate"><span class="pre">saberTraining.training()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id23"><code class="docutils literal notranslate"><span class="pre">saberTraining.update_pickle_file()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-astrosaber">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astrosaber.UnsupportedPythonError"><code class="docutils literal notranslate"><span class="pre">UnsupportedPythonError</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/astrosaber.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, Jonas Syed.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>